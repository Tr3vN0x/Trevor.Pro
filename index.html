<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survival Evolved: Sprite Edition</title>
    <style>
        body { margin: 0; background: #050508; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; }
        #overlay { position: absolute; top: 20px; left: 20px; color: white; pointer-events: none; }
        .bar { width: 200px; height: 10px; background: rgba(0,0,0,0.5); border: 1px solid #444; margin: 5px 0; }
        #hp { width: 100%; height: 100%; background: #ff416c; transition: 0.3s; }
    </style>
</head>
<body>

    <div id="overlay">
        <div style="font-weight: bold; font-size: 20px;">SURVIVOR</div>
        <div class="bar"><div id="hp"></div></div>
        <div id="stamina-ui" style="font-size: 12px; color: #00f2ff;">DASH READY [SHIFT]</div>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // --- SPRITE LOADING ---
    const charSprite = new Image();
    // Replace the URL below with your actual hosted image link!
    charSprite.src = 'https://i.postimg.cc/your-image-here.png'; 

    const world = { gravity: 0.5, tiles: [] };
    const player = {
        x: 500, y: 300, vx: 0, vy: 0,
        w: 50, h: 80, // Size adjusted for your character
        speed: 5, jump: 12,
        flip: false, 
        dashTimer: 0,
        isAttacking: 0
    };

    // Generate terrain
    for(let x=0; x<200; x++) {
        world.tiles[x] = [];
        let ground = 12 + Math.floor(Math.sin(x*0.1)*3);
        for(let y=0; y<30; y++) {
            if(y > ground) world.tiles[x][y] = (y > ground + 5) ? '#444' : '#5d4037';
        }
    }

    const keys = {};
    window.onkeydown = e => keys[e.code] = true;
    window.onkeyup = e => keys[e.code] = false;

    function update() {
        // Movement & Dash
        let moveSpeed = player.speed;
        if(keys['ShiftLeft'] && player.dashTimer === 0) {
            player.vx = player.flip ? -20 : 20;
            player.dashTimer = 50; // Cooldown
        }
        
        if (keys['KeyA']) { player.vx = -moveSpeed; player.flip = true; }
        else if (keys['KeyD']) { player.vx = moveSpeed; player.flip = false; }
        else { player.vx *= 0.8; }

        if (keys['Space'] && player.grounded) {
            player.vy = -player.jump;
            player.grounded = false;
        }

        player.vy += world.gravity;
        player.x += player.vx;
        player.y += player.vy;

        // Tile Collision
        let tx = Math.floor(player.x / 40);
        let ty = Math.floor((player.y + player.h/2) / 40);
        if(world.tiles[tx] && world.tiles[tx][ty]) {
            player.y = ty * 40 - player.h/2;
            player.vy = 0;
            player.grounded = true;
        }

        if(player.dashTimer > 0) player.dashTimer--;
    }

    function draw() {
        ctx.fillStyle = '#0a192f';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.save();
        ctx.translate(canvas.width/2 - player.x, canvas.height/2 - player.y);

        // Draw Tiles
        for(let x = Math.floor(player.x/40)-15; x < Math.floor(player.x/40)+15; x++) {
            for(let y=0; y<30; y++) {
                if(!world.tiles[x] || !world.tiles[x][y]) continue;
                ctx.fillStyle = world.tiles[x][y];
                ctx.fillRect(x*40, y*40, 40, 40);
                if(world.tiles[x][y-1] == null) {
                    ctx.fillStyle = '#2d5a27'; // Grass top
                    ctx.fillRect(x*40, y*40, 40, 5);
                }
            }
        }

        // Draw Your Character
        ctx.save();
        ctx.translate(player.x, player.y);
        if(player.flip) ctx.scale(-1, 1);
        
        // If image is loaded, use it. Otherwise, draw a placeholder.
        if(charSprite.complete) {
            // This pulls the side-view section of your image
            // Parameters: img, sourceX, sourceY, sourceW, sourceH, destX, destY, destW, destH
            ctx.drawImage(charSprite, 400, 50, 200, 500, -30, -50, 60, 100);
        } else {
            ctx.fillStyle = '#ff416c';
            ctx.fillRect(-15, -40, 30, 80);
        }
        ctx.restore();

        ctx.restore();
        update();
        requestAnimationFrame(draw);
    }

    draw();
</script>
</body>
</html>
